%% ------------------------------------------------------------------------- %%
\chapter{Introdução}
\label{cap:introducao}


Recuperação de trecho de código-fonte (\textit{code retrieval}) consiste em recuperar um trecho de código de um repositório, de modo a atender às intenções do desenvolvedor, descritas em linguagem natural. A capacidade de recuperar trechos de códigos relevantes é importante para produtividade \citep{sadowski-how-developers-search-for-code-case-study:2015}. Atualmente, a maioria dos desenvolvedores recorrem a ferramentas de busca como o Google para encontrar trechos de código-fonte, relembrar a sintaxe de alguma linguagem de programação ou conferir exemplos de uso de bibliotecas de programação \citep{masudur-developers-use-google-code-retrieval:2018}.

As ferramentas de busca, como o Google, utilizam estratégias de indexação e ranqueamento de páginas que não são otimizadas para código-fonte. Neste caso, os buscadores não conseguem extrair a semântica por trás do código-fonte, a não ser que o código esteja acompanhado de um texto explicativo. Segundo \cite{masudur-developers-use-google-code-retrieval:2018}, os desenvolvedores levam mais tempo, visitam mais páginas web e alteram com mais frequência uma consulta a fim de encontrar um resultado relevante para sua pesquisa relacionada a código-fonte quando comparada a uma busca não relacionada a código.


A busca semântica por trecho de código tem sido um desafio. Atualmente, o site do GitHub, que hospeda milhares de projetos de código-aberto, não possui um mecanismo de pesquisa que
seja capaz de recuperar um trecho de código-fonte relevante a partir dos termos utilizados no campo de busca. Pesquisadores do GitHub tentaram criar uma busca semântica, ao extrair milhares de trechos de código de repositórios do \Gls{github} e associar a textos \gls{docstring}. Porém, os resultados não foram satisfatórios, pois a busca somente retornava resultados relevantes quando o usuário utilizasse palavras-chaves similares às palavras presentes nos comentários \gls{docstring} \citep{husain-github-semantic-search-code-2019}. 

Pesquisadores do Facebook \citep{cambronero-deep-learning-code-search:2019} também verificaram este problema e constataram que comentários \gls{docstring} não conseguem extrair a semântica do código-fonte de forma a atender às intenções do usuário em uma busca. Esses autores verificaram que as intenções dos usuários foram melhor expressas através de questões extraídas de comunidades abertas de perguntas e respostas, como o \gls{sof}. Nestas comunidades abertas de perguntas e respostas, o conhecimento é construído coletivamente pelos usuários, que organizam e curam as informações. Essas comunidades acabam tornando-se um valioso repositório de informações \citep{Wang-quora:2013}. 

No caso do \Gls{sof}, os usuários expressam suas perguntas em linguagem natural e outros usuários podem responder com trechos de código-fonte. Além disso, o próprio usuário que fez a pergunta, pode apontar qual é a resposta correta. E outros usuários podem votar na resposta que eles acharam mais relevante ou indicar se uma resposta está incorreta, pontuando negativamente a mesma. Essas ações coletivas feitas pelos usuários ajudam na curadoria e organização da informação, facilitando a busca por informações relevantes \citep{Wang-quora:2013, cambronero-deep-learning-code-search:2019}. 

Atualmente diversas conquistas foram obtidas na área de inteligência artificial através do uso das redes neurais artificiais. As redes neurais artificiais mostraram-se capazes de reconhecer voz e imagem, fazer diagnósticos médicos e traduções com desempenho, muitas vezes, equiparável ao do ser humano. Este avanço refletiu também nos trabalhos sobre recuperação de trecho de código-fonte. Os primeiros trabalhos para criar uma busca semântica de trecho de código-fonte baseavam-se em sistemas baseados em regras e características extraídas manualmente do código-fonte. O sucesso das redes neurais artificiais fez com que os trabalhos migrassem de ferramentas baseadas em regras lógico-dedutivas e extração manual de caractéristicas para ferramentas baseadas em aprendizagem de máquina utilizando redes neurais artificiais. Segundo \cite{cambronero-deep-learning-code-search:2019}, a maioria dos trabalhos feitos na academia e indústria atualmente em direção a uma busca mais avançada de código-fonte utilizaram redes neurais artificiais \citep{Gu-deep-code-search:2018, yao-2018, iyer-etal-2016-summarizing, Allamanis-bimodal-source-code-natural-language:2015, Chen-bi-variational-autoencoder:2018, Sachdev-neural-code-search:2018, cambronero-deep-learning-code-search:2019}. \cite{cambronero-deep-learning-code-search:2019} cunharam o termo \textit{neural code search}, i.e., busca de código-fonte através do uso de redes neurais artificiais.


A maioria dos trabalhos utilizaram redes neurais artificiais para sumarizar e recuperar trechos de código-fonte \citep{iyer-etal-2016-summarizing, Allamanis-bimodal-source-code-natural-language:2015, Chen-bi-variational-autoencoder:2018}. Apesar de uma mesma arquitetura de rede neural mostrar-se 
útil em diversas tarefas \acrshort{nlp}, sumarização e recuperação automática de código-fonte são duas tarefas distintas, cada uma com suas peculiaridades, desafios e métricas de avaliação de desempenho \citep{allahyari-text-summarization-2017}. O nosso trabalho avalia uma proposta de arquitetura de redes neurais artificiais apenas para a tarefa de recuperação de trechos de código-fonte. E diferente do trabalho de \cite{Gu-deep-code-search:2018} que propôs uma arquitetura com redes neurais recorrentes e do trabalho de \cite{cambronero-deep-learning-code-search:2019} que utilizou redes neurais com mecanismo de atenção, nós utilizamos uma arquitetura composta por redes neurais convolucionais, que apresentaram um bom desempenho em tarefas de seleção de resposta em \acrshort{nlp} \citep{feng-2015, tan-lstm-qa, wen-joint-modeling-question-answer-2019}.


Um ponto importante a ser ressaltado é o fato de termos utilizado uma arquitetura comumente utilizada na tarefa de seleção de respostas em \acrshort{nlp} na recuperação de trechos de código-fonte. A seleção de respostas em NLP consiste em recuperar a resposta mais relevante de um conjunto de possíveis respostas a partir de uma questão. Tanto as respostas quanto as questões estão expressas em linguagem natural. Enquanto na recuperação de trecho de código-fonte, somente a intenção de busca está expressa em linguagem natural.  

A partir destas considerações, as perguntas que este trabalho pretende responder são:

\begin{itemize}
    \item Aprendizagem de representação através de uma arquitetura CNN auxilia na recuperação de trecho de código-fonte?
    
    \item Será que o CNN é capaz de extrair as características latentes e mais importantes de modo a facilitar o modelo a encontrar uma correlação entre os trechos de código-fonte e as intenções expressas em linguagem natural?
\end{itemize}

Indiretamente, dado que o CNN prioriza interações locais, estaremos respondendo também a seguinte pergunta:
\begin{itemize}
        \item As interações locais auxiliam na aproximação das intenções aos trechos de código-fonte?
\end{itemize}

Para respondê-las, avaliaremos um modelo que busca aproximar as intenções aos trechos de código-fonte. Para isto, o modelo vai ser estimulado a aproximar as suas representações. Estas representações serão obtidas a partir da nossa arquitetura CNN. A avaliação final do modelo será feita em um conjunto de dados composto por pares de questões e trechos de código-fonte coletados do site Stack Overflow. 


%% ------------------------------------------------------------------------- %%
\section{Considerações Preliminares}
\label{sec:consideracoes_preliminares}

O foco deste trabalho é a recuperação de trecho de código-fonte. Diferentemente dos trabalhos de \cite{iyer-etal-2016-summarizing} e \cite{Allamanis-bimodal-source-code-natural-language:2015} que abordaram também o problema de sumarização de código-fonte ou \textit{code summarization}. Para podermos avaliar a nossa arquitetura, iremos compará-la com outras arquiteturas de referência e com a arquitetura proposta por \cite{cambronero-deep-learning-code-search:2019} que é o estado da arte atualmente. Em relação aos dados, a base de dados disponibilizada por \cite{yao-2018} contém pares de questões e trechos de código-fonte em Python e SQL. A princípio, utilizaremos apenas os pares de perguntas e código-fonte em Python.


%% ------------------------------------------------------------------------- %%
\section{Objetivos}
\label{sec:objetivo}

O objetivo principal deste trabalho é propor uma nova arquitetura para a recuperação de trecho de código-fonte. Queremos avaliar se o uso de redes convolucionais auxiliam na obtenção de um modelo que seja capaz de aproximar os trechos de código-fonte as intenções do desenvolvedor. 

%% ------------------------------------------------------------------------- %%
\section{Contribuições}
\label{sec:contribucoes}

Dentre as contribuições deste trabalho estão:

\begin{itemize}
\item Proposta de uma nova abordagem para uma busca semântica de código-fonte;
\item Avaliação de uma nova arquitetura;
\item Avaliação do modelo utilizando uma nova base de dados disponibilizada por \cite{yao-2018};
\item Disponibilização do código-fonte, desde o pré-processamento até a avaliação final, em um repositório público;
\end{itemize}

%% ------------------------------------------------------------------------- %%
\section{Organização do Trabalho}
\label{sec:organizacao_trabalho}

No Capítulo~\ref{cap:fundamentacao-teorica}, apresentamos os conceitos e trabalhos relacionados a recuperação de trecho de código-fonte. No Capítulo~\ref{cap:abordagem}, apresentamos a nossa abordagem para o item de pesquisa proposto. No Capítulo~\ref{cap:experimento}, exibimos os resultados da arquitetura proposta utilizando os dados de \cite{yao-2018}. Já no Capítulo~\ref{cap:conclusoes}, apresentamos as nossas conclusões e os próximos passos para trabalhos futuros.